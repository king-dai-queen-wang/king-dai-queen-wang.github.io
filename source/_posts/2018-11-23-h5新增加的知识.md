---
title: h5新增加的知识
date: 2018-11-23 10:52:27
tags:
---
## H5 新增内容

### 一.新的选择器
* document.querySelector('xxx') (相当于$())
   > 只能选择一个元素
* document.querySelectorAll('xx')
   > 选组一组元素
* document.getElementsByClassName('xx')
    >通过class name来选择一组元素

### 二.获取class列表属性
*    classList
>   - length: class的长度
>   - add(): 添加class方法
>   - remove（）： 删除class方法
>   - toggle（）： 切换class方法

```
<div id="div1" class="box1 box2 box3 box4"></div>

<script>
    window.onLoad = function(){
        var oDiv = document.getElementById('div1')
        oDiv.classList//    类数组[box1 box2 box3 box4]
        oDiv.classList.add('box5')  // box1 box2 box3 box4 box5
        oDiv.classList.remove('box2')   // box1 box3 box4 box5
        oDiv.classList.toggle('box2') //如果box2已经在改classList里了则删除box2，如果不存在则添加box2
    }
</script>
    
```

### 三.data-xxx

```
<div id="div1" data-haha="haha" data-haha-wawa>div</div>
<script>
window.onload= function(){
    var oDiv = document.getElementById("div1");
    alert(oDiv.dataset.haha)   
    alert(oDiv.dataset.hahaWawa) 
}
</script>
```

### 四.延迟加载JS
H5的defer和async
* defer：延迟加载，会按顺序执行， 在onload前被触发

* async: 异步加载，加载完就触发，有顺序问题

```
<script src="a.js" defer="defer"></script> 
<!-- 会等其他元素加载完，在window.onload之前加载，
只能加在引用外部资源的script标签上，写在内联的script是无效的 -->
<script src="b.js"></script>
<script src="c.js"></script>
<!--========华丽的分割线=======================-->
<script src="d.js" async="async"></script>
<script src="e.js" async="async"></script>
<!--异步加载，谁先加载完会执行谁，一般用于广告-->
```

### 五.H5拖拽
* 拖拽元素事件： 事件对象为被拖拽元素

```

 dragstart,拖拽前触发

 drag，拖拽前，拖拽结束之间，连续触发

 dragend， 拖拽结束触发
 
```

* 目标元素事件，事件对象为目标元素

```

 dragenter, 进入目标元素触发，相当于mouseover

 dragover, 进入目标，离开目标之间，连续触发

 dragleave， 离开目标元素触发，相当于mouseout

 drop ,在目标元素上释放鼠标触发

```
#### 拖放事件

* 事件的执行顺序： drop不触发的时候
    
    ```
        dragstart > drag > dragenter > dragover > dragleave > dragend 
    ```
    
* 事件的执行顺序： drop触发的时候（dragover的时候组织默认事件）

    ```
        dragstart > drag > dragenter > dragover > drop > drapend 
    ```

* 不能释放的时候的光标和能释放的光标不一样

* 解决火狐下的问题
    - 必须设置dataTransfer对象的setData方法才可以拖拽图片外的标签

* dataTransfer对象
    ```
        setData() 设置数据key 和value（必须是字符串）
        getData（） 获取数据，根据key值，获取对应的value 
    ```
    
      
[mycode(H5拖拽)-->](https://codepen.io/daivd_dai/pen/zMWWpM)

---
## Tips:

1. transform 属性

> this.style.transform = "function";

```markdown
    function值如下
    none 定义不进行转换。
    matrix(n,n,n,n,n,n)	定义 2D 转换，使用六个值的矩阵。
    matrix3d(n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n)	定义 3D 转换，使用 16 个值的 4x4 矩阵。
    translate(x,y)	定义 2D 转换。
    translate3d(x,y,z)	定义 3D 转换。
    translateX(x)	定义转换，只是用 X 轴的值。
    translateY(y)	定义转换，只是用 Y 轴的值。
    translateZ(z)	定义 3D 转换，只是用 Z 轴的值。
    scale(x[,y]?)	定义 2D 缩放转换。
    scale3d(x,y,z)	定义 3D 缩放转换。
    scaleX(x)	通过设置 X 轴的值来定义缩放转换。
    scaleY(y)	通过设置 Y 轴的值来定义缩放转换。
    scaleZ(z)	通过设置 Z 轴的值来定义 3D 缩放转换。
    rotate(angle)	定义 2D 旋转，在参数中规定角度。rotate(90deg) 顺时针旋转90度，rotate(-90deg) 逆时针旋转90度
    rotate3d(x,y,z,angle)	定义 3D 旋转。
    rotateX(angle)	定义沿着 X 轴的 3D 旋转。
    rotateY(angle)	定义沿着 Y 轴的 3D 旋转。
    rotateZ(angle)	定义沿着 Z 轴的 3D 旋转。
    skew(x-angle,y-angle)	定义沿着 X 和 Y 轴的 2D 倾斜转换。
    skewX(angle)	定义沿着 X 轴的 2D 倾斜转换。
    skewY(angle)	定义沿着 Y 轴的 2D 倾斜转换。
    perspective(n)	为 3D 转换元素定义透视视图。

```
[transform 属性 code示例 ](https://c.runoob.com/codedemo/3391)

2. 旋转中心默认时该元素的中心点

> 若想调整旋转中心和过渡时间

```
    this.style.transformOrigin = "left";
    this.style.transitionDuration ="1s" ;
```

在预览图片的时候

```
    // 点击图片预览功能
    
    oImg.onclick= function(e){
        let oDiv = document.createElement("div");
        let deleteSpan = document.createElement("span");
        let previewArea = document.createElement("img");
        previewArea.src = e.target.src;
        oDiv.appendChild(previewArea);
        deleteSpan.style="position: fixed;top: 0px; right: 0px;width: 40px;height: 40px;line-height:40px;text-align: center;background-color: white;border-radius: 20px;"
        deleteSpan.innerHTML = 'x'; // 创建删除btn
        deleteSpan.onclick= function(){
            oDiv.remove();
        }
         oDiv.appendChild(deleteSpan);
         oDiv.style = "background: rgba(51, 51, 51,0.2);position: fixed;top: 0;bottom: 0;left: 0;right: 0;align-items: center;justify-content: center;display: flex;";
         
         // 遮罩层样式 【！！！background这里必须通过rgba设置透明度，否则直接用opcity设置的画，里面的子元素btn也会应用上父遮罩层的透明度】
         
         document.body.appendChild(oDiv);
   }
   
```